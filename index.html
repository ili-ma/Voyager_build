<!DOCTYPE html>
<html lang="en-us">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>Unity WebGL Player | Voyager</title>
		<link rel="shortcut icon" href="TemplateData/favicon.ico">
	</head>
	<body>
		<p id="controls"></p>
		<script>
			let url = new URL(document.location.href);
			let isPreview = !url.searchParams.get("assignmentId");
			let skippedTutorial = !!url.searchParams.get("skipTutorial");
			var RuleVariant = url.searchParams.get("rules") || "LocalSampling";

			function makeButton(condition, trueText, falseText, key, value)
			{
				let button = document.createElement("button");
				button.innerHTML = condition ? trueText : falseText;
				button.addEventListener("click", function() {
					if (condition) url.searchParams.set(key, value);
					else url.searchParams.delete(key);
					document.location.href = url.toString();
				});
				return button;
			}

			let controls = document.getElementById("controls");
			controls.appendChild(makeButton(isPreview, "Accept HIT", "Go to Preview", "assignmentId", "a_very_real_id"));
			controls.appendChild(makeButton(!skippedTutorial, "Skip Tutorial", "Go To Tutorial", "skipTutorial", "yep"));
			let ruleP = document.createElement("p");
			ruleP.innerHTML = "Rules: " + RuleVariant;
			controls.appendChild(ruleP)
			controls.appendChild(makeButton(true, "Local Sampling", "", "rules", "LocalSampling"));
			controls.appendChild(makeButton(true, "Remote Sensing", "", "rules", "RemoteSensing"));
		</script>

		<!-- mTurk section starts here. Don't forget to replace relative locations with absolute ones! -->
		<link rel="stylesheet" href="TemplateData/style.css" type="text/css">
		<script src="TemplateData/UnityProgress.js"></script>
		<script src="Build/UnityLoader.js"></script>
		<script>
			var unityInstance = UnityLoader.instantiate("unityContainer", "Build/Voyager_build.json", {onProgress: UnityProgress});
		</script>
		<!-- Uncomment on mTurk
		<script>
			var RuleVariant = ${RuleVariant};
		</script>
		-->
		<div class="webgl-content">
			<div id="unityContainer" style="width: 960px; height: 600px"></div>
			<div class="footer">
				<div class="fullscreen" onclick="unityInstance.SetFullscreen(1)"></div>
				<div class="title">Make Fullscreen</div>
			</div>
		</div>
		<textarea rows="5" cols="80" name="Log" id="logField" required hidden></textarea>
		<p id="progress"></p>
		<!-- mTurk section ends here -->

		<button type="button" id="submitButton" onclick="alert(document.getElementById('logField').value)">Submit</button>
	</body>
</html>
